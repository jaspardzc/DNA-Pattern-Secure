package com.mypersonalapp.dnapatternsecure;

import android.content.Context;
import android.content.Intent;
import android.content.pm.PackageInfo;
import android.content.pm.PackageManager;
import android.content.pm.ResolveInfo;
import android.util.Log;

import java.util.List;

/**
 * Created by jaspe_000 on 4/29/2015.
 */
public class MalwareDetector {
	private List<String[]> permissionList;
	private Context context;
	public MalwareDetector(Context context) {
        this.context = context.getApplicationContext();
	}
	
	public List<String> getPermissionList(List<String> permissionList) {
		final Intent mainIntent = new Intent(Intent.ACTION_MAIN, null);
		mainIntent.addCategory(Intent.CATEGORY_LAUNCHER);
		final List pkgAppsList = context.getPackageManager().queryIntentActivities(mainIntent, 0);
		for (Object obj : pkgAppsList) {
			ResolveInfo resolveInfo = (ResolveInfo) obj;
			PackageInfo packageInfo = null;
			try {
				packageInfo = context.getPackageManager().getPackageInfo(resolveInfo.activityInfo.packageName, PackageManager.GET_PERMISSIONS);
			} catch (PackageManager.NameNotFoundException e) {
				e.printStackTrace();
			}
			String[] requestedPermissions = packageInfo.requestedPermissions;
            for (String str : requestedPermissions) {
                permissionList.add(str);
            }
		}
		return permissionList;
	}
	
	public void getAllPermissions() {
		if (permissionList.size() != 0) {
			for (int i = 0; i < permissionList.size(); i++) {
				Log.d("Permission: ", "permissionList.get(i)");
			}
		}
	}
	/**
	* How to detect if one application is potentially malicious?
	* 1. BlackList
	* 2. Those who send SMS automatically
	* 3. Having access to file system without notification
	* 4. Not download from the Official APP Store, say like Google Play Store
	* 5. And more...
	*/
}
